# AI-X-Deeplearning-project

### Title: 태아 검사 데이터를 이용한 건강 상태 분류

### Members: 
          김서현, 전기공학전공, doodne2001@hanyang.ac.kr
          최준영, 전기공학전공, jyoki@hanyang.ac.kr
          최태욱, 전기공학전공, terry03@hanyang.ac.kr


## Index
####           I. Proposal
####           II. Datasets
####           III. Methodology
####           IV. Code guide
####           V. Results & Analysis
####           VI. Conclusion

--------------------------------------------------------------------------------------------------------------------------------------------------------------------

## I. Proposal (Option A)

### Motivation:

&nbsp;&nbsp;&nbsp;최근 AI와 딥러닝 기술의 발전은 다양한 분야에 큰 변화를 가져오고 있습니다. 그중에서도 의료 분야에서는 바이오 신호와 생체 데이터 분석을 통해 진단과 예측의 정확도가 크게 향상되고 있습니다. 특히, 태아의 건강 상태를 정량적으로 평가하고 분류하는 문제는 산모와 태아의 안전을 위해 매우 중요합니다.

&nbsp;&nbsp;&nbsp;과거에는 의료진이 여러 신호와 임상 데이터에 기반하여 수동적인 판단을 내렸으나, 인공지능 및 딥러닝 모델을 활용하면 방대한 데이터를 효율적으로 분석하고 복잡한 변수 간의 관계를 효과적으로 파악할 수 있습니다. 이를 통해 의료진의 부담은 줄이고, 조기 진단 및 위험 감지 가능성을 높일 수 있습니다.

### Our Goal:

&nbsp;&nbsp;&nbsp;이번 프로젝트에서는 "Fetal Health Classification" 데이터셋(21개의 바이오 신호 특성, 1개의 결과 변수)을 활용하여, 딥러닝 기반으로 태아 건강 상태(정상, 의심, 병리적)를 분류하는 모델을 설계 및 실험해보고자 합니다. 이 프로젝트는 딥러닝 기법을 실제 건강 데이터에 적용해보고, 의료 데이터 특유의 클래스 불균형과 특성 해석 등 현장에서의 복잡한 문제도 함께 경험하는 데 목적이 있습니다. 이렇게 얻은 경험은 앞으로 다양한 의료 데이터 분석 및 지능형 진단 시스템 개발에 도움이 될 것으로 기대됩니다.

--------------------------------------------------------------------------------------------------------------------------------------------------------------------

## II. Datasets

본 프로젝트에서 사용할 Dataset은 다음과 같습니다. (출처: https://www.kaggle.com/datasets/andrewmvd/fetal-health-classification)

| 피처명                    | 설명                                 | 범위                                          |
|---------------------------|--------------------------------------|-------------------------------------------------|
| Baseline_Value                  | 태아의 평균 심박수(bpm)          | 106 ~ 160                               |
| Accelerations                   | 초당 심박수 증가 횟수                | 0.0 ~ 0.019                                   |
| Fetal_Movement                  | 초당 태아 움직임 횟수                | 0.0 ~ 0.481       |
| Uterine_Contractions            | 초당 자궁 수축 횟수             | 0.0 ~ 0.014                           |
| Light_Decelerations             | 초당 가벼운 심박수 감소 횟수         | 0.0 ~ 0.015                           |
| Severe_Decelerations            | 초당 심한 심박수 감소 횟수           | 0.0 ~ 0.001                            |
| Prolonged_Decelerations         | 초당 장기적인 심박수 감소 횟수            | 0.0 ~ 0.005       |
| Abnormal_Short_Term_Variability | 비정상적인 단기 심박 감소 횟수            | 12.0 ~ 87.0                        |
| Mean_Value_of_Short_Term_Variability| 단기 심박 변동성의 평균값           | 0.2 ~ 7.0           |
| Percentage_of_Time_With_Abnormal_Long_Term_Variability| 전체 시간 중 비정상 장기 심박 변동성이 나타나는 비율| 0.0 ~ 91.0      |
| Mean_Value_of_Long_Term_Variability| 장기 심박 변동성의 평균값        | 0.0 ~ 50.7    |
| Histogram_Width         | 단기 변동성 하스토그램의 구간 너비  | 3.0 ~ 180.0       |
| Histogram_Min                | 단기 변동성 최솟값         | 50.0 ~ 159.0                        |
| Histogram_Max                 | 단기 변동성 최댓값                  | 122.0 ~ 238.0                               |
| Histogram_Number_of_Peaks               | 단기 변동성 히스토그램의 봉우리 개수           | 0.0 ~ 18.0        |
| Histogram_Number_of_Zeros      | 단기 변동성 히스토그램에서 값이 0인 수         | 0.0 ~ 10.0             |
| Histogram_Mode           | 히스토그램의 최빈값             | 60.0 ~ 187.0                     |
| Histogram_Mean          | 히스토그램의 평균값               | 73.0 ~ 182.0                  |
| Histogram_Median       | 히스토그램의 중앙값                    |77.0 ~ 186.0        |
| Histogram_Variance | 히스토그램 값들의 분산              | 0.0 ~ 269.0                |
| Histogram_Tendancy       | 히스토그램 값들의 전반적 경향성           | -1.0 ~ 1.0                |
| Fetal_Health | 태아의 건강상태          | 1:정상, 2:의심, 3:병리적                  |

--------------------------------------------------------------------------------------------------------------------------------------------------------------------

## III. Methodology

## III.1 데이터 전처리 (Data Processing)<br><br>

#### 1. 결측치 및 이상치 처리

&nbsp;&nbsp;&nbsp;먼저 dataset 내에서의 결측값을 점검합니다. 만약 결측값이 존재한다면 보간, 중앙값 대체 및 제거 등의 방법 중 상황에 맞는 방식을 적용합니다.

#### 2. 정규화 및 표준화

&nbsp;&nbsp;&nbsp;각 특성의 값 분포가 다르므로 학습 안정성과 효율성을 위한 스케일링이 필요합니다. 분포가 비정규가 명확한 경우 Min-Max 스케일링을 사용하여 값을 0~1 범위로 매핑하고, 평균이 0, 분산이 1이 되도록 표준화를 적용할 특성에는 StandardScaler를 사용합니다. 이 과정을 통해 딥러닝 모델의 수렴 속도를 높이고 학습 안정성을 향상시킬 수 있습니다.

#### 3. 클래스 불균형 처리

&nbsp;&nbsp;&nbsp;타깃 레이블인 Fetal_Health는 정상, 의심, 병리적 클래스 간의 분포가 불균형적일 가능성이 높습니다. 그러므로 이를 보정하기 위해 SMOTE (Synthetic Minority Over-Sampling Technique) 등의 오버샘플링 혹인 클래스 가중치를 부여하는 방식 등을 고려해 볼 수 있습니다.<br><br>
  

## III.2 특성 탐색 및 탐색 (Feature Selection & Exploration)<br><br>


#### 1. 상관관계 분석

&nbsp;&nbsp;&nbsp;21개 바이오 신호 특성 간 상관 행렬 계산을 통해 높은 상관관계를 보이는 지표를 식별합니다. 이 때 상관이 매우 높은 특성 쌍은 다중공선성의 원인이 될 수 있으므로, 변수 축소나 특성 선택 가능성을 평가합니다.

#### 2. 히스토그램 시각화

&nbsp;&nbsp;&nbsp;각 특성의 분포를 파악하기 위해 아래와 같이 히스토그램을 그립니다. 이를 통해 데이터의 왜도, 이상치, 집중 구간 등을 파악할 수 있습니다.

#### 3. 특성 중요도 평가

&nbsp;&nbsp;&nbsp;랜덤 포레스트, XGBoost 등 트리 기반 모델을 사용해 각 특성의 예측 기여도를 계산합니다. 그 후 중요 특성을 도출하여 이후 모델 설계에 반영합니다.<br><br>


## III.3 모델 구조 설계 (Model Architecture)<br><br>


#### 1. 입력층

&nbsp;&nbsp;&nbsp;21개의 정규화된 바이오 신호 특성을 벡터의 형태로 입력받습니다.

#### 2. 은닉층

&nbsp;&nbsp;&nbsp;다중 퍼셉트론 구조를 사용하며 Batch Normalization 레이어를 배치하여 내부 공변량 변화를 완하하고 학습 안정성을 개선합니다. 또한 Dropout 레이어를 삽입하여 과적합을 줄입니다.

#### 3. 출력층

&nbsp;&nbsp;&nbsp;3개의 클래스(정상, 의심, 병리적)에 대한 softmax 활성화를 통해 각 클래스에 대한 예측 확률을 제공합니다.<br><br>


## III.4 학습 및 평가 방법 (Training & Evaluation)<br><br>


#### 1. 데이터 분할

&nbsp;&nbsp;&nbsp;학습, 검증용으로 데이터를 분할(8:2 비율)하여 모델의 일반화 성능을 평가합니다. 검증 세트를 통해 모델의 일반화 성능을 실시간으로 평가하고 과적합 여부를 확인합니다.

#### 2. 손실 함수 및 최적화

&nbsp;&nbsp;&nbsp;다중 함수 문제이므로 Cross-Entropy Loss를 사용합니다. 최적화에는 Adam Optimizer를 사용하여 학습 속도를 개선합니다.

#### 3.하이퍼파라미터 튜닝

&nbsp;&nbsp;&nbsp;은닉층의 노드 수, 학습률 등 주요 하이퍼파라미터를 실험하며, 최적의 모델 구조를 찾아내기 위해 Grid Search 혹은 Optuna를 활용합니다.

#### 4. 성능 평가 지표

&nbsp;&nbsp;&nbsp;정확도(전체 예측의 정밀성), F1-score(클래스 불균형을 고려한 조화평균), Confusion Matrix(클래수별 오분류 분석) 등 다양한 지표로 모델의 성능을 종합적으로 평가합니다.<br><br>


## III.5 결과 해석 및 신뢰성 확보 (Model Interpretation & Reliability)<br><br>


#### 1. 모델 해석

&nbsp;&nbsp;&nbsp;SHAP(각 특성이 예측에 얼마나 기여했는지 정밀하게 분석하는 방법), LIME(개별 예측에 대해 국소적 성명을 제공하여 실제 사례별 해석 가능성을 높이는 방법) 등 모델 해석 기법을 통해 실제로 예측에 큰 영향을 미친 특성을 분석합니다.

#### 2. 결과 시각화

&nbsp;&nbsp;&nbsp;주요 특성의 분포, 예측 결과(혼동행렬, ROC 곡선 등)를 시각화합니다.
